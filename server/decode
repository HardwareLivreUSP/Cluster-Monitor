#/bin/bash

# decode [nome host] [arquivo]
cat - | base64 --decode > input
tar -zxvf input > /dev/null 2> /dev/null

name=$(head -n 1 data)

if openssl dgst -sha256  -verify ../keys/$name.pem -keyform PEM -signature signature data  > /dev/null 2> /dev/null; then
    cat data
fi

rm signature input data  > /dev/null 2> /dev/null
